function sort_list_images(){jQuery(".sortable").sortable()}jQuery(document).ready(function(e){if(jQuery("#style_download").change(function(){var e=jQuery(this).parents("#meta_download");"video"==jQuery(this).val()?(e.find("#video").show(),e.find("#audio").hide()):(e.find("#audio").hide(),e.find("#video").hide())}),jQuery("select.global_config").length>0){var i=jQuery("select.global_config");i.each(function(){var e=jQuery(this).val(),i=jQuery(this).attr("data-config");i+=e,jQuery(i).show(),jQuery(this).on("change",function(){var e=jQuery(this).find("option:selected").val(),i=jQuery(this).attr("data-config"),l=i+"sub";i+=e,jQuery(l).hide(),jQuery(i).show()})})}clear_button=e(".clear-all-slides"),e(".sortable").each(function(i,l){e(l).find("li").length>0?e(this).parent(".sortable-wrapper").siblings(".clear-all-slides").show():e(this).parent(".sortable-wrapper").siblings(".clear-all-slides").hide()}),clear_button.click(function(){e(this).siblings(".sortable-wrapper").children(".sortable").html(""),e(this).hide()}),count_id=Math.floor(1e3*Math.random()+1),count_id=parseInt(count_id);var l=!1;fancy=e(".preview-img-edit").fancybox({minWidth:450,minHeight:450,beforeLoad:function(){},beforeClose:function(){l=!1}}),e(".save-slide").live("click",function(){e(".fancybox-close").trigger("click")}),e(".sortable").disableSelection(),sort_list_images();var t=!0;"undefined"!=typeof wp.media.editor&&(_orig_send_attachment=wp.media.editor.send.attachment),e(".stag-metabox-table").click(function(){var i=(wp.media.editor.send.attachment,e(this)),l=e(this).siblings(".sortable-wrapper").children(".sortable"),a=e(this).siblings(".clear-all-slides");return t=!0,wp.media.editor.send.attachment=function(e,i){var n="";n="undefined"!=typeof i.sizes.thumbnail?i.sizes.thumbnail.url:i.sizes[e.size].url;var s=i.sizes.full.url,d=e.linkUrl;"file"==e.link&&(d=i.url),"post"==e.link&&(d=i.link),"none"==e.link&&(d="#");var r=i.title,u=i.description,m=i.alt;return build_html="",count_id=i.id,t?(build_html+='<div id="image-value'+count_id+'" class="hidden lightbox-image">',build_html+='<img  class="lightbox-preview-img" src="'+s+'" alt="'+m+'" title="'+r+'">',build_html+='<input type="hidden" value="'+count_id+'" name="element_id[]" class="inline-element element_id">',build_html+='<input type="hidden" value="'+n+'" name="thumb_url[]" id="thumb_url" class="inline-element element_thumb">',build_html+='<input type="hidden" value="'+s+'" id="element_image_url" name="element_image_url[]" class="inline-element insert_url">',build_html+='<p><span class="label">Slide Url</span><input type="text" value="'+d+'" name="element_url[]" class="inline-element link_url"></p>',build_html+='<p><span class="label">Image Title</span><input type="text" value="'+r+'" name="element_title[]" class="inline-element image_title "></p>',build_html+='<p><span class="label">Image Alt</span><input type="text" value="'+m+'" name="element_alt[]" class="inline-element image_alt"></p>',build_html+='<p><span class="label">Slide Title</span><input type="text" value="'+r+'" name="slide_title[]" class="inline-element slide_title"></p>',build_html+='<p><span class="label">Slide Contents</span><textarea name="slide_content[]" class="inline-element slide_content">'+u+"</textarea></p>",build_html+='<div class="btn fancy-button-wrapper"><a href="javascript:void(0)" class="button save-slide" name="save-slide"/>Save</a>',build_html+='<a href="javascript:void(0)" class="button save-slide" name="close-slide"/>Close</a></div>',build_html+="</div>",build_html+='<p class="image-wrappper">',build_html+='<img  class="preview-img" src="'+n+'" alt="'+m+'" title="'+r+'" width="120" height="120">',build_html+='<a href="#image-value'+count_id+'" class="preview-img-edit">Edit</a>',build_html+='<a href="javascript:void(0)" class="preview-img-remove">Del</a>',build_html+="</p>",jQuery('<li class="ui-state-default"></li>').html(build_html).appendTo(l),a.show(),void 0):_orig_send_attachment.apply(this,[e,i])},wp.media.editor.open(i),sort_list_images(),!1}),e(".stag-metabox-table-gallery").click(function(){var i=(wp.media.editor.send.attachment,e(this)),l=e(this).siblings(".sortable-wrapper").children(".sortable"),a=e(this).siblings(".clear-all-slides");return t=!0,wp.media.editor.send.attachment=function(e,i){var n="";n="undefined"!=typeof i.sizes.thumbnail?i.sizes.thumbnail.url:i.sizes[e.size].url;var s=i.sizes.full.url,d=e.linkUrl;"file"==e.link&&(d=i.url),"post"==e.link&&(d=i.link),"none"==e.link&&(d="#");var r=i.title,u=(i.description,i.alt);return build_html="",count_id=i.id,t?(build_html+='<input type="hidden" value="'+count_id+'" name="g_element_id[]" class="inline-element element_id">',build_html+='<input type="hidden" value="'+n+'" name="g_thumb_url[]" class="inline-element element_thumb">',build_html+='<input type="hidden" value="'+d+'" name="g_element_url[]" class="inline-element link_url">',build_html+='<input type="hidden" value="'+r+'" name="g_element_title[]" class="inline-element image_title ">',build_html+='<input type="hidden" value="'+u+'" name="g_element_alt[]" class="inline-element image_alt">',build_html+='<input type="hidden" value="'+s+'" id="element_image_url" name="element_image_url[]" class="inline-element insert_url">',build_html+='<p class="image-wrappper">',build_html+='<img  class="preview-img" src="'+n+'" alt="'+u+'" title="'+r+'" width="120" height="120">',build_html+='<a href="javascript:void(0)" class="preview-img-remove">Del</a>',build_html+="</p>",jQuery('<li class="ui-state-default"></li>').html(build_html).appendTo(l),a.show(),void 0):_orig_send_attachment.apply(this,[e,i])},wp.media.editor.open(i),sort_list_images(),!1}),e(".add_media").on("click",function(){t=!1}),e(".image-wrappper > .preview-img-remove").live("click",function(){var i=(e(this),e(this).closest(".sortable")),l=e(this).closest(".sortable-wrapper").siblings(".clear-all-slides");e(this).parent().parent().remove(),i.find("li").length>0?l.show():l.hide(),sort_list_images()})});